<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Expense Splitter</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="./images/triply-icon.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Poppins', sans-serif;
    background: #f5f7fa;
    color: #333;
    line-height: 1.6;
    min-height: 100vh;
}

.container {
    max-width: 700px;
    margin: 40px auto;
    padding: 30px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
}

h1 {
    text-align: center;
    margin-bottom: 30px;
    font-size: 2.2rem;
    color: #13c892;
    text-shadow: 1px 1px 4px rgba(19, 200, 146, 0.3);
    animation: fadeIn 1s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.step-indicator {
    display: flex;
    justify-content: space-between;
    margin-bottom: 30px;
    font-size: 0.9rem;
    color: #666;
}

.step-indicator span {
    flex: 1;
    text-align: center;
    padding: 8px;
    background: #e0e6ed;
    border-radius: 6px;
    transition: all 0.3s;
}

.step-indicator span.active {
    background: #13c892;
    color: #fff;
    transform: scale(1.05);
}

.step {
    display: none;
    animation: slideIn 0.5s ease;
}

.step.active {
    display: block;
}

@keyframes slideIn {
    from { opacity: 0; transform: translateX(20px); }
    to { opacity: 1; transform: translateX(0); }
}

h2 {
    font-size: 1.6rem;
    margin-bottom: 20px;
    color: #0f9f71;
    position: relative;
}

h2::after {
    content: '';
    position: absolute;
    left: 0;
    bottom: -5px;
    width: 50%;
    height: 3px;
    background: #13c892;
    border-radius: 2px;
}

h3 {
    font-size: 1.2rem;
    margin-bottom: 15px;
    color: #13c892;
}

.form-group {
    margin-bottom: 15px;
}

label {
    display: block;
    margin-bottom: 5px;
    color: #666;
}

input, select {
    width: 100%;
    padding: 12px;
    border: 1px solid #e0e6ed;
    border-radius: 8px;
    background: #f9fafc;
    color: #333;
    font-size: 1rem;
    transition: all 0.3s;
}

input:focus, select:focus {
    outline: none;
    border-color: #13c892;
    box-shadow: 0 0 8px rgba(19, 200, 146, 0.3);
    background: #fff;
}

button {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    background: #13c892;
    color: #fff;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s;
}

button:hover {
    background: #3ce2a9;
    transform: translateY(-2px);
    box-shadow: 0 4px 16px rgba(19, 200, 146, 0.3);
}

button:active {
    transform: translateY(0);
}

button.back {
    background: #e0e6ed;
    color: #666;
}

button.back:hover {
    background: #d0d7e1;
    color: #333;
}

ul {
    list-style: none;
}

ul li {
    padding: 8px 0;
    font-size: 1rem;
    color: #666;
    transition: color 0.3s;
}

ul li:hover {
    color: #13c892;
}

#involvedPeople {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    margin-top: 10px;
}

#involvedPeople label {
    display: flex;
    align-items: center;
    color: #666;
    cursor: pointer;
}

#involvedPeople input[type="checkbox"] {
    width: auto;
    margin-right: 8px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    background: #f9fafc;
    border-radius: 8px;
    overflow: hidden;
}

th, td {
    padding: 12px;
    text-align: left;
}

th {
    background: #13c892;
    color: #fff;
    font-size: 0.9rem;
}

td {
    color: #333;
    border-bottom: 1px solid #e0e6ed;
}

tr:hover {
    background: #e0e6ed;
}

#balances p {
    padding: 10px;
    background: #f9fafc;
    border-radius: 8px;
    margin: 5px 0;
    color: #666;
    transition: transform 0.3s;
}

#balances p:hover {
    transform: translateX(5px);
    background: #e0e6ed;
}

.error {
    color: #ff4757;
    font-size: 0.9rem;
    margin-top: 5px;
}

.success {
    color: #13c892;
    font-size: 0.9rem;
    margin-top: 5px;
}

.button-group {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
}

.button-group button {
    min-width: 120px;
}

.expense-list {
    margin-top: 20px;
}

.expense-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background: #f9fafc;
    border-radius: 8px;
    margin-bottom: 10px;
    transition: all 0.3s;
}

.expense-item:hover {
    transform: translateX(5px);
    background: #e0e6ed;
}

.expense-details {
    flex-grow: 1;
}

.expense-details h4 {
    margin: 0;
    color: #333;
}

.expense-details p {
    margin: 5px 0 0;
    color: #666;
    font-size: 0.9rem;
}

.expense-amount {
    font-weight: 600;
    color: #13c892;
}

.delete-expense {
    background: none;
    border: none;
    color: #ff4757;
    cursor: pointer;
    padding: 5px;
    margin-left: 10px;
    transition: all 0.3s;
}

.delete-expense:hover {
    transform: scale(1.2);
}

@media (max-width: 600px) {
    .container {
        margin: 20px;
        padding: 20px;
    }

    h1 {
        font-size: 1.8rem;
    }

    .step-indicator {
        font-size: 0.8rem;
    }

    .button-group {
        flex-direction: column;
        gap: 10px;
    }

    .button-group button {
        width: 100%;
    }

    .expense-item {
        flex-direction: column;
        text-align: center;
    }

    .expense-amount {
        margin-top: 10px;
    }

    .delete-expense {
        margin-top: 10px;
    }
}
    </style>
</head>
<body>
    <header>
        <img src="./images/triply_logo.png" alt="logo" height="100%">
        <nav>
            <div class="dropdown">
                <button class="dropdown-btn">Explore</button>
                <div class="dropdown-content">
                    <a href="explore.html">Itinerary</a>
                    <a href="split.html">Split Bills</a>
                </div>
            </div>
            <a href="blog.html">Blog</a>
            <a href="mailto:triply@gmail.com">Contact Us</a>
        </nav>
        <div class="login-signup">
            <div id="loggedInState" style="display: none;">
                <span id="welcomeUser"></span>
                <button onclick="handleLogout()" class="logout-btn">Logout</button>
            </div>
            <div id="loggedOutState">
                <a href="./login-page.html" class="login-btn">Login</a>
                <a href="./sign_up.html" class="signup-btn">Sign up</a>
            </div>
        </div>
    </header>
    <div class="container">
        <h1>Travel Expense Splitter</h1>
        <div class="step-indicator">
            <span class="active">Step 1: Add People</span>
            <span>Step 2: Add Expenses</span>
            <span>Step 3: View Summary</span>
        </div>

        <div id="step1" class="step active">
            <h2>Add People</h2>
            <div class="form-group">
                <label for="personName">Name</label>
                <input type="text" id="personName" placeholder="Enter name">
                <button onclick="addPerson()">Add Person</button>
            </div>
            <h3>Added People:</h3>
            <ul id="peopleList"></ul>
            <div class="button-group">
                <button onclick="nextStep(2)" id="step1Next" disabled>Next</button>
            </div>
        </div>

        <div id="step2" class="step">
            <h2>Add Expenses</h2>
            <div class="form-group">
                <label for="expenseDescription">Description</label>
                <input type="text" id="expenseDescription" placeholder="Enter expense description">
            </div>
            <div class="form-group">
                <label for="expenseAmount">Amount</label>
                <input type="number" id="expenseAmount" placeholder="Enter amount">
            </div>
            <div class="form-group">
                <label for="paidBy">Paid By</label>
                <select id="paidBy"></select>
            </div>
            <div class="form-group">
                <label>Split Between</label>
                <div id="involvedPeople"></div>
            </div>
            <button onclick="addExpense()">Add Expense</button>
            <div class="expense-list" id="expensesList"></div>
            <div class="button-group">
                <button class="back" onclick="previousStep(1)">Back</button>
                <button onclick="nextStep(3)" id="step2Next" disabled>Next</button>
            </div>
        </div>

        <div id="step3" class="step">
            <h2>Summary</h2>
            <div id="expenseSummary"></div>
            <h3>Balances</h3>
            <div id="balances"></div>
            <div class="button-group">
                <button class="back" onclick="previousStep(2)">Back</button>
                <button onclick="resetCalculator()">Start Over</button>
            </div>
        </div>
    </div>

    <script>
        let people = [];
        let expenses = [];
        let currentStep = 1;

        function addPerson() {
            const nameInput = document.getElementById('personName');
            const name = nameInput.value.trim();
            
            if (name && !people.includes(name)) {
                people.push(name);
                nameInput.value = '';
                updatePeopleList();
                updatePaidBySelect();
                updateInvolvedPeople();
                document.getElementById('step1Next').disabled = people.length < 2;
            }
        }

        function updatePeopleList() {
            const list = document.getElementById('peopleList');
            list.innerHTML = people.map(person => `<li>${person}</li>`).join('');
        }

        function updatePaidBySelect() {
            const select = document.getElementById('paidBy');
            select.innerHTML = `<option value="">Select person</option>` +
                             people.map(person => `<option value="${person}">${person}</option>`).join('');
        }

        function updateInvolvedPeople() {
            const container = document.getElementById('involvedPeople');
            container.innerHTML = people.map(person => `
                <label>
                    <input type="checkbox" value="${person}" checked>
                    ${person}
                </label>
            `).join('');
        }

        function addExpense() {
            const description = document.getElementById('expenseDescription').value.trim();
            const amount = parseFloat(document.getElementById('expenseAmount').value);
            const paidBy = document.getElementById('paidBy').value;
            const involved = Array.from(document.querySelectorAll('#involvedPeople input:checked')).map(cb => cb.value);

            if (description && amount > 0 && paidBy && involved.length > 0) {
                expenses.push({
                    description,
                    amount,
                    paidBy,
                    splitBetween: involved
                });

                document.getElementById('expenseDescription').value = '';
                document.getElementById('expenseAmount').value = '';
                document.getElementById('paidBy').value = '';

                updateExpensesList();
                document.getElementById('step2Next').disabled = expenses.length === 0;
            }
        }

        function updateExpensesList() {
            const list = document.getElementById('expensesList');
            list.innerHTML = expenses.map((expense, index) => `
                <div class="expense-item">
                    <div class="expense-details">
                        <h4>${expense.description}</h4>
                        <p>Paid by ${expense.paidBy}</p>
                        <p>Split between: ${expense.splitBetween.join(', ')}</p>
                    </div>
                    <span class="expense-amount">$${expense.amount.toFixed(2)}</span>
                    <button class="delete-expense" onclick="deleteExpense(${index})">Ã—</button>
                </div>
            `).join('');
        }

        function deleteExpense(index) {
            expenses.splice(index, 1);
            updateExpensesList();
            document.getElementById('step2Next').disabled = expenses.length === 0;
        }

        function calculateBalances() {
            let balances = {};
            people.forEach(person => balances[person] = 0);

            expenses.forEach(expense => {
                const perPerson = expense.amount / expense.splitBetween.length;
                balances[expense.paidBy] += expense.amount;
                expense.splitBetween.forEach(person => {
                    balances[person] -= perPerson;
                });
            });

            return balances;
        }

        function updateSummary() {
            const summaryDiv = document.getElementById('expenseSummary');
            const balancesDiv = document.getElementById('balances');
            const balances = calculateBalances();

            let totalExpenses = expenses.reduce((sum, expense) => sum + expense.amount, 0);
            summaryDiv.innerHTML = `<h3>Total Expenses: $${totalExpenses.toFixed(2)}</h3>`;

            let balanceHTML = '';
            for (let person in balances) {
                const amount = balances[person];
                const formattedAmount = Math.abs(amount).toFixed(2);
                if (amount > 0) {
                    balanceHTML += `<p>${person} is owed $${formattedAmount}</p>`;
                } else if (amount < 0) {
                    balanceHTML += `<p>${person} owes $${formattedAmount}</p>`;
                }
            }
            balancesDiv.innerHTML = balanceHTML;
        }

        function nextStep(step) {
            document.querySelector(`.step-indicator span:nth-child(${currentStep})`).classList.remove('active');
            document.querySelector(`.step-indicator span:nth-child(${step})`).classList.add('active');
            
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.getElementById(`step${step}`).classList.add('active');
            
            currentStep = step;
            
            if (step === 3) {
                updateSummary();
            }
        }

        function previousStep(step) {
            document.querySelector(`.step-indicator span:nth-child(${currentStep})`).classList.remove('active');
            document.querySelector(`.step-indicator span:nth-child(${step})`).classList.add('active');
            
            document.getElementById(`step${currentStep}`).classList.remove('active');
            document.getElementById(`step${step}`).classList.add('active');
            
            currentStep = step;
        }

        function resetCalculator() {
            people = [];
            expenses = [];
            currentStep = 1;
            
            document.querySelectorAll('.step-indicator span').forEach(span => span.classList.remove('active'));
            document.querySelector('.step-indicator span:first-child').classList.add('active');
            
            document.querySelectorAll('.step').forEach(step => step.classList.remove('active'));
            document.getElementById('step1').classList.add('active');
            
            document.getElementById('peopleList').innerHTML = '';
            document.getElementById('expensesList').innerHTML = '';
            document.getElementById('expenseSummary').innerHTML = '';
            document.getElementById('balances').innerHTML = '';
            
            document.getElementById('step1Next').disabled = true;
            document.getElementById('step2Next').disabled = true;
        }
    </script>
</body>
</html>